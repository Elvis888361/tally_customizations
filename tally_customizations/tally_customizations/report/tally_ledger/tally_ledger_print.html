<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>{{ title }}</title>
	<style>
		@media print {
			body {
				margin: 0;
				padding: 20px;
			}
			@page {
				margin: 15mm;
			}
		}

		body {
			font-family: Arial, sans-serif;
			font-size: 9pt;
			color: #000;
			line-height: 1.3;
		}

		.page-header {
			margin-bottom: 10px;
		}

		.header-row {
			display: flex;
			justify-content: space-between;
			align-items: flex-start;
		}

		.company-info {
			text-align: center;
			flex: 1;
		}

		.company-name {
			font-size: 11pt;
			font-weight: bold;
			margin-bottom: 2px;
		}

		.company-contact {
			font-size: 8pt;
			color: #666;
		}

		.page-number {
			font-size: 8pt;
			color: #666;
			white-space: nowrap;
			padding-left: 20px;
		}

		.account-info {
			text-align: center;
			margin: 15px 0;
		}

		.account-name {
			font-size: 12pt;
			font-weight: bold;
			margin: 3px 0;
		}

		.account-type {
			font-size: 9pt;
			margin: 2px 0;
		}

		.date-range {
			font-size: 9pt;
			margin-top: 8px;
		}

		.ledger-table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 15px;
		}

		.ledger-table thead tr {
			border-top: 1px solid #000;
			border-bottom: 1px solid #000;
		}

		.ledger-table th {
			padding: 5px 4px;
			text-align: left;
			font-weight: normal;
			font-size: 9pt;
		}

		.ledger-table td {
			padding: 3px 4px;
			font-size: 9pt;
			vertical-align: top;
		}

		.ledger-table th.right,
		.ledger-table td.right {
			text-align: right;
		}

		.opening-row {
			font-weight: bold;
		}

		.closing-row {
			font-weight: bold;
		}

		.subtotal-row {
			border-top: 1px solid #000;
			font-weight: normal;
		}

		.total-row {
			border-bottom: 2px double #000;
			font-weight: normal;
		}

		.subtotal-row td,
		.total-row td {
			padding-top: 5px;
			padding-bottom: 5px;
		}

		/* Column widths */
		.col-sr-no { width: 5%; }
		.col-date { width: 10%; }
		.col-particulars { width: 25%; }
		.col-vch-type { width: 12%; }
		.col-vch-no { width: 18%; }
		.col-debit { width: 15%; }
		.col-credit { width: 15%; }
	</style>
</head>
<body>
	<div class="page-header">
		<div class="header-row">
			<div class="company-info">
				<div class="company-name">{{ company }}</div>
				{% if company_address %}
				<div class="company-contact">{{ company_address }}</div>
				{% endif %}
			</div>
			<div class="page-number">Page 1</div>
		</div>
	</div>

	<div class="account-info">
		<div class="account-name">{{ account_name }}</div>
		<div class="account-type">{{ ledger_type }}</div>
		{% if account_name != ledger_type %}
		<div class="account-type">{{ account_name.split()[0] if account_name else "" }}</div>
		{% endif %}
		<div class="date-range">{{ from_date }} to {{ to_date }}</div>
	</div>

	<table class="ledger-table">
		<thead>
			<tr>
				<th class="col-sr-no">Sr No</th>
				<th class="col-date">Date</th>
				<th class="col-particulars">Particulars</th>
				<th class="col-vch-type">Vch Type</th>
				<th class="col-vch-no">Vch No /Excise Inv No</th>
				<th class="col-debit right">Debit</th>
				<th class="col-credit right">Credit</th>
			</tr>
		</thead>
		<tbody>
			{% set ns = namespace(counter=0) %}
			{% for row in data %}
			{% set is_opening = row.particulars and 'Opening Balance' in row.particulars %}
			{% set is_closing = row.particulars and 'Closing Balance' in row.particulars %}
			{% set is_empty_with_totals = (not row.particulars or row.particulars == '') and row.debit and row.credit %}
			{% if is_empty_with_totals %}
				{% if loop.last %}
					{% set is_subtotal = false %}
					{% set is_total = true %}
				{% else %}
					{% set is_subtotal = true %}
					{% set is_total = false %}
				{% endif %}
			{% else %}
				{% set is_subtotal = false %}
				{% set is_total = false %}
			{% endif %}
			{% set is_regular_row = not (is_opening or is_closing or is_empty_with_totals) %}
			{% if is_regular_row %}
				{% set ns.counter = ns.counter + 1 %}
			{% endif %}
			<tr class="{% if is_opening %}opening-row{% elif is_closing %}closing-row{% elif is_subtotal %}subtotal-row{% elif is_total %}total-row{% endif %}">
				<td class="col-sr-no">
					{% if is_regular_row %}
						{{ ns.counter }}
					{% endif %}
				</td>
				<td class="col-date">
					{% if row.posting_date and row.posting_date != '' %}
						{{ row.posting_date }}
					{% endif %}
				</td>
				<td class="col-particulars">
					{% if is_closing %}
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{ row.particulars or "Closing Balance" }}
					{% else %}
						{{ row.particulars or "" }}
					{% endif %}
				</td>
				<td class="col-vch-type">{{ row.vch_type or "" }}</td>
				<td class="col-vch-no">{{ row.vch_no or "" }}</td>
				<td class="col-debit right">
					{{ row.debit if row.debit else "" }}
				</td>
				<td class="col-credit right">
					{{ row.credit if row.credit else "" }}
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</body>
</html>